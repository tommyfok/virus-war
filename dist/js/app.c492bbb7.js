(function(t){function e(e){for(var i,r,s=e[0],u=e[1],d=e[2],l=0,f=[];l<s.length;l++)r=s[l],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&f.push(a[r][0]),a[r]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(t[i]=u[i]);c&&c(e);while(f.length)f.shift()();return o.push.apply(o,d||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],i=!0,s=1;s<n.length;s++){var u=n[s];0!==a[u]&&(i=!1)}i&&(o.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},a={app:0},o=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/virus-war/dist/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=e,s=s.slice();for(var d=0;d<s.length;d++)e(s[d]);var c=u;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"container"}},[n("div",{attrs:{id:"virusmap"}}),n("div",{attrs:{id:"dayinfo"}},[t._v("第"+t._s(t.day)+"天")]),n("ul",{attrs:{id:"info"}},[n("li",{staticStyle:{color:"white"}},[t._v("未感染("+t._s(t.totalCount-t.infectCount)+")")]),n("li",{staticStyle:{color:"yellow"}},[t._v("已感染("+t._s(t.infectCount)+")")]),n("li",{staticStyle:{color:"red"}},[t._v("已确诊("+t._s(t.quezhenCount)+")")]),n("li",{staticStyle:{color:"white"}},[t._v("空余床位数："+t._s(t.freeBedNum))]),n("li",{staticStyle:{color:"white"}},[t._v("死亡人数："+t._s(t.deadCount))]),n("li",{staticStyle:{color:"green"}},[t._v("康复人数："+t._s(t.healCount))])]),n("div",{class:{expand:t.showForm},attrs:{id:"form"}},[t.showForm?t._e():n("a",{staticClass:"btn btn-open",on:{click:t.toggleForm}},[t._v("+ 调整参数")]),t.showForm?n("a",{staticClass:"btn btn-close",on:{click:t.toggleForm}},[t._v("+")]):t._e(),t.showForm?n("div",{staticClass:"form-content"},[n("div",[t._v("人员活动范围："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.人员活动范围,expression:"人员活动范围"}],attrs:{type:"number"},domProps:{value:t.人员活动范围},on:{input:function(e){e.target.composing||(t.人员活动范围=e.target.value)}}})]),n("div",[t._v("每天活动人数比例："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.每天活动人数比例,expression:"每天活动人数比例"}],attrs:{type:"number"},domProps:{value:t.每天活动人数比例},on:{input:function(e){e.target.composing||(t.每天活动人数比例=e.target.value)}}})]),n("div",[t._v("最大床位数："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.maxFreeBedNum,expression:"maxFreeBedNum"}],attrs:{type:"number"},domProps:{value:t.maxFreeBedNum},on:{input:function(e){e.target.composing||(t.maxFreeBedNum=e.target.value)}}})]),n("div",[t._v("感染范围："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.infectSize,expression:"infectSize"}],attrs:{type:"number"},domProps:{value:t.infectSize},on:{input:function(e){e.target.composing||(t.infectSize=e.target.value)}}})]),n("div",[t._v("初始感染人数："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.initInfectCount,expression:"initInfectCount"}],attrs:{type:"number"},domProps:{value:t.initInfectCount},on:{input:function(e){e.target.composing||(t.initInfectCount=e.target.value)}}})]),n("div",[t._v("同区域感染率："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.infectRate,expression:"infectRate"}],attrs:{type:"number"},domProps:{value:t.infectRate},on:{input:function(e){e.target.composing||(t.infectRate=e.target.value)}}})]),n("div",[t._v("样本数："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.totalCount,expression:"totalCount"}],attrs:{type:"number"},domProps:{value:t.totalCount},on:{input:function(e){e.target.composing||(t.totalCount=e.target.value)}}})]),n("div",[t._v("自愈概率："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.selfHealRate,expression:"selfHealRate"}],attrs:{type:"number"},domProps:{value:t.selfHealRate},on:{input:function(e){e.target.composing||(t.selfHealRate=e.target.value)}}})]),n("div",[t._v("住院康复概率："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.hospitalHealRate,expression:"hospitalHealRate"}],attrs:{type:"number"},domProps:{value:t.hospitalHealRate},on:{input:function(e){e.target.composing||(t.hospitalHealRate=e.target.value)}}})]),t.inited?t._e():n("button",{staticClass:"confirm",on:{click:t.init}},[t._v("开始模拟")]),t.inited&&t.paused?n("button",{staticClass:"confirm",on:{click:t.toggleForm}},[t._v("继续")]):t._e(),t.inited&&t.paused?n("button",{staticClass:"confirm",on:{click:t.init}},[t._v("重新开始模拟")]):t._e()]):t._e()])])},o=[],r=(n("99af"),n("4de4"),n("4160"),n("caad"),n("c975"),n("159b"),n("a5cf")),s=1e4,u=5,d=.3,c=5,l=.1/c,f=s/2e3,h=14,p=.1,v=.9,m=25,_=s/500,y=null,g=[];function x(){for(var t=0,e=0;e<6;e++)t+=Math.random();return t/6}function C(t){return t[Math.floor(Math.random()*t.length)]}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=[];if(t.length<=e)return n.concat(t);while(n.length<e){var i=C(t);n.includes(i)||n.push(i)}return n}var b={name:"app",data:function(){return{showForm:!0,day:1,dayTimer:null,deadCount:0,healCount:0,infectCount:0,quezhenCount:0,"人员活动范围":u,"每天活动人数比例":d,freeBedNum:_,maxFreeBedNum:_,infectSize:c,initInfectCount:f,totalCount:s,selfHealRate:p,hospitalHealRate:v,infectRate:l,inited:!1,paused:!1}},mounted:function(){this.showForm=!0},methods:{createPoint:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16777215,e=x()*y.renderer.width,n=x()*y.renderer.height,i=new r["b"];return i.beginFill(t),i.drawCircle(0,0,.5),i.endFill(),y.stage.addChild(i),i.x=e,i.y=n,i.__xindex=Math.floor(i.x/this.infectSize),i.__yindex=Math.floor(i.y/this.infectSize),i},pause:function(){this.paused=!0},goon:function(){this.paused=!1},init:function(){y&&y.destroy(),g=[],this.inited=!0,this.paused=!1,this.day=1,this.freeBedNum=this.maxFreeBedNum||_,this.deadCount=0,this.healCount=0,this.infectCount=0,this.quezhenCount=0,this.人员活动范围=this.人员活动范围||u,this.selfHealRate=this.selfHealRate||p,this.hospitalHealRate=this.hospitalHealRate||v,this.每天活动人数比例=this.每天活动人数比例||d,this.infectSize=this.infectSize||c,this.initInfectCount=this.initInfectCount||f,this.infectRate=this.infectRate||l,y=new r["a"]({resizeTo:document.getElementById("virusmap")}),document.getElementById("virusmap").innerHTML="",document.getElementById("virusmap").appendChild(y.view);for(var t=0;t<this.totalCount;t++){var e=this.createPoint();g.push(e)}this.infectPoints(this.initInfectCount),y.ticker.add(this.tickHandler),this.startDayTimer(),this.showForm=!1},tickHandler:function(){this.paused||({},g.forEach(this.goAround))},startDayTimer:function(){var t=this;this.dayTimer&&clearInterval(this.dayTimer),this.dayTimer=setInterval((function(){t.paused||(t.day++,t.updateHealed(),t.updateDead(),t.updateQueZhen(),t.updateInfect(),t.infectCount===t.quezhenCount&&t.infectCount>0&&(alert("恭喜，您在第".concat(t.day,"天控制住了疫情！")),t.pause()))}),1e3)},heal:function(t){if(2===t.infectStatus){!0===t.__inHospital&&this.freeBedNum++;var e=this.createPoint(65280);e.infectStatus=3,e.x=t.x,e.y=t.y,e.__xindex=t.__xindex,e.__yindex=t.__yindex;var n=g.indexOf(t);g[n]=e,t.destroy(),y.stage.addChild(e),this.healCount++}},dead:function(t){if(2===t.infectStatus){this.deadCount++,!0===t.__inHospital&&this.freeBedNum++;var e=this.createPoint(3355443);e.infectStatus=4,e.x=t.x,e.y=t.y,e.__xindex=t.__xindex,e.__yindex=t.__yindex;var n=g.indexOf(t);g[n]=e,t.destroy(),y.stage.addChild(e)}},updateHealed:function(){var t=this;g.forEach((function(e){e.__healDay===t.day&&t.heal(e)}))},updateDead:function(){var t=this;g.forEach((function(e){e.__deadDay===t.day&&t.dead(e)}))},updateInfect:function(){var t=this,e=(Math.floor(y.renderer.width/this.infectSize),Math.floor(y.renderer.height/this.infectSize),{});for(var n in g.forEach((function(t){var n="".concat(t.__xindex,",").concat(t.__yindex);e[n]=e[n]||[],e[n].push(t)})),e){var i=e[n],a=i.filter((function(t){return!t.infectStatus})),o=i.filter((function(t){return 1===t.infectStatus})),r=i.filter((function(t){return 2===t.infectStatus})),s=o.length+r.length;s>0&&a.forEach((function(e){var n=Math.random()<t.infectRate;n&&t.infect(e)}))}},updateQueZhen:function(){var t=this;g.forEach((function(e){e.__queZhenDay===t.day&&t.queZhen(e)}))},infectPoints:function(t){w(g,t).forEach(this.infect)},goAround:function(t){2===t.infectStatus&&t.__inHospital||4===t.infectStatus||Math.random()<this.每天活动人数比例&&(t.x+=x()*this.人员活动范围-this.人员活动范围/2,t.y+=x()*this.人员活动范围-this.人员活动范围/2,t.__xindex=Math.floor(t.x/c),t.__yindex=Math.floor(t.y/c))},infect:function(t){if(!(t.infectStatus>0)){this.infectCount++;var e=this.createPoint(15990621);e.infectStatus=1,e.x=t.x,e.y=t.y,e.__xindex=t.__xindex,e.__yindex=t.__yindex,e.__infectDay=this.day,e.__queZhenDay=this.day+Math.ceil(h*x());var n=g.indexOf(t);g[n]=e,t.destroy(),y.stage.addChild(e)}},queZhen:function(t){if(!(t.infectStatus>1)){this.quezhenCount++;var e=this.createPoint(16711680);if(e.infectStatus=2,e.x=t.x,e.y=t.y,this.freeBedNum>0){this.freeBedNum--;var n=Math.random()<this.hospitalHealRate,i=this.day+Math.ceil(m*x());e.__inHospital=!0,n?e.__healDay=i:e.__deadDay=i}else{var a=Math.random()<this.selfHealRate,o=this.day+Math.ceil(m*x());a?e.__healDay=o:e.__deadDay=o}var r=g.indexOf(t);g[r]=e,t.destroy(),y.stage.addChild(e)}},toggleForm:function(){this.showForm=!this.showForm,!0===this.showForm?this.paused||this.pause():this.paused&&this.goon()}}},S=b,H=(n("7c55"),n("2877")),P=Object(H["a"])(S,a,o,!1,null,null,null),R=P.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(R)}}).$mount("#app")},7743:function(t,e,n){},"7c55":function(t,e,n){"use strict";var i=n("7743"),a=n.n(i);a.a}});
//# sourceMappingURL=app.c492bbb7.js.map